# 1. Python 프로바이더 사용
providers = ["python"]

# 2. apt-get update 무한 로딩 방지 (필수 단계 덮어쓰기)
[phases.setup]
cmds = ["echo 'Skipping slow apt-get update...'"]

# 3. 시스템 패키지 설치 (Nix 패키지 매니저 이용)
[packages]
# --- 기본 유틸리티 (apt 대체) ---
curl = "latest"
wget = "latest"
ca-certificates = "latest"
openssl = "latest"

# --- Python 환경 ---
# uv.lock에 >=3.13이 명시되어 있으므로 3.13 버전을 요청합니다.
python313 = "latest"
uv = "latest"
gcc = "latest" # C 확장이 있는 라이브러리(mss, uvicorn 등) 빌드용

# --- Browser (Nodriver용) ---
chromium = "latest"
# --- ✨ [핵심] 폰트 및 렌더링 라이브러리 추가 ✨ ---
# 이게 없으면 headless 모드에서 요소 찾을 때 죽습니다.
fontconfig = "latest"
noto-fonts = "latest"
noto-fonts-cjk = "latest" # 한글 폰트 (필수)
noto-fonts-emoji = "latest"

# --- GUI 라이브러리 (기존 유지) ---
xorg.libX11 = "latest"
xorg.libxcb = "latest"
libxkbcommon = "latest"
glib = "latest"
nss = "latest"
nspr = "latest"
at-spi2-core = "latest"
alsa-lib = "latest"       # 소리 관련이지만 크롬 안정성에 도움됨
cups = "latest"           # 프린팅 관련이지만 크롬 의존성 중 하나

# 5. Build 단계 (필요시)
[phases.build]
cmds = ["echo 'Building...'"]

# 6. 실행 명령어 (Coolify UI 설정을 우선하지만, 파일에도 명시하면 좋습니다)
[start]
cmd = "uv run fastapi run main.py"